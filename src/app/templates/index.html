<!DOCTYPE html>

<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">


    <title>Geometry Diagram Builder</title>
    <meta name="description" content="Geometry Diagram Builder">

    <script src="{{ url_for('static',filename='js/jquery-3.5.1.min.js') }}"></script>
    <script src="{{ url_for('static',filename='js/jquery-ui.min.js') }}"></script>

    <link rel="stylesheet" href="{{ url_for('static',filename='css/jquery-ui.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static',filename='css/style.css') }}" />



    <script type="text/javascript">

      window.onload = function () {
          var cm = CodeMirror.fromTextArea(document.getElementById('editor'), {
              mode: "text/x-common-lisp",
              lineNumbers: true,
              matchBrackets: true,
              autoCloseBrackets: true,
              keyMap: "emacs",
              theme: "3024-day"
          });
          cm.setSize("100%", "100%");

          var five_circle_cm = CodeMirror.fromTextArea(document.getElementById('five-circle'), {
              mode: "text/x-common-lisp",
              lineNumbers: true,
              readOnly: true,
              keyMap: "emacs",
              theme: "3024-day",
              cursorBlinkRate: -1
          });
          var fc_string = "(PARAM (P0 P1 P2 P3 P4) polygon)\n"
          fc_string += "\n(COMPUTE Q1 (interLL (line P0 P1) (line P2 P3)))"
          fc_string += "\n(COMPUTE Q2 (interLL (line P1 P2) (line P3 P4)))"
          fc_string += "\n(COMPUTE Q3 (interLL (line P2 P3) (line P4 P0)))"
          fc_string += "\n(COMPUTE Q4 (interLL (line P3 P4) (line P0 P1)))"
          fc_string += "\n(COMPUTE Q0 (interLL (line P4 P0) (line P1 P2)))\n"

          fc_string += "\n(COMPUTE M1 (interCC (circ Q0 P0 P1) (circ Q1 P1 P2) (rsNeq P1)))"
          fc_string += "\n(COMPUTE M2 (interCC (circ Q1 P1 P2) (circ Q2 P2 P3) (rsNeq P2)))"
          fc_string += "\n(COMPUTE M3 (interCC (circ Q2 P2 P3) (circ Q3 P3 P4) (rsNeq P3)))"
          fc_string += "\n(COMPUTE M4 (interCC (circ Q3 P3 P4) (circ Q4 P4 P0) (rsNeq P4)))"
          fc_string += "\n(COMPUTE M0 (interCC (circ Q4 P4 P0) (circ Q0 P0 P1) (rsNeq P0)))\n"

          fc_string += "\n(CONFIRM (onCirc M3 (circ M0 M1 M2)))"
          fc_string += "\n(CONFIRM (onCirc M4 (circ M0 M1 M2)))"

          five_circle_cm.setValue(fc_string);
          five_circle_cm.setSize("100%", "100%");
          five_circle_cm.getWrapperElement().style["font-size"] = "17px";
          five_circle_cm.refresh();

          function handleFileSelect(evt) {
              var files = evt.target.files; // FileList object

              // use the 1st file from the list
              f = files[0];

              var reader = new FileReader();

              // Closure to capture the file information
              reader.onload = (function(theFile) {

                  return function(e) {
                      cm.setValue(e.target.result);
                      // console.log(e.target.result);
                  };
              })(f);

              // Read in the image file as a data URL
              reader.readAsText(f);
          }

          document.getElementById('upload-problem').addEventListener('change', handleFileSelect, false);

          // var dImg = document.getElementById('diagram-img');
          $(document).ajaxStart(function() {
              $("img.d-block").each(function (index, element){
                  element.style.opacity = "0.5";
              });
              // dImg.style.opacity = "0.5";
          }).ajaxStop(function() {
              $("img.d-block").each(function (index, element){
                  element.style.opacity = "1.0";
              });
              // dImg.style.opacity = "1.0";
          });

          $('#solve-btn').click(function() {
              $.ajax({
                  url: "{{ url_for ('solve') }}",
                  type: "POST",
                  // global: false,
                  data: {
                      problem_input: cm.getValue(),
                      n_models: document.getElementById('num-models').value
                  },

                  success: function(response) {
                      console.log(response);

                      if (response['srcs'].length == 0) {


                          document.getElementById("alerts").innerHTML =
                              "<div class=\"alert alert-danger\" role=\"alert\">Failure: Found 0 diagrams</div>";
                          document.getElementById('myCarousel').innerHTML =
                              "<div class=\"carousel-item active\"><img src=\"{{ url_for('static',filename='img/empty-diag.jpg') }}\" class=\"d-block w-100\" alt=\"Image 1\" id=\"diagram-img\"></div>";

                          document.getElementById('carousel-targets').innerHTML = "<li data-target=\"#carouselExampleControls\" data-slide-to=\"0\" class=\"active\"></li>";

                      } else {

                          var carousel_inner = "";
                          var i;
                          for (i = 0; i < response['srcs'].length; i++) {
                              var tmp_src = response['srcs'][i];
                              var first_div_line = "<div class=\"carousel-item\">";
                              if (i == 0) {
                                  first_div_line = "<div class=\"carousel-item active\">";
                              }
                              carousel_inner +=
                                  first_div_line +
                                  "<img src=" + tmp_src + " class=\"d-block w-100\"></div>";
                          }
                          document.getElementById('myCarousel').innerHTML = carousel_inner

                          var carousel_targets = "";
                          for (i = 0; i < response['srcs'].length; i++) {
                              if (i == 0) {
                                  carousel_targets +=
                                      "<li data-target=\"#carouselExampleControls\" data-slide-to=\"0\" class=\"active\"></li>"
                              } else {
                                  carousel_targets +=
                                      "<li data-target=\"#carouselExampleControls\" data-slide-to=\"" + i.toString + "\"></li>"
                              }
                          }
                          document.getElementById('carousel-targets').innerHTML = carousel_targets;

                          document.getElementById("alerts").innerHTML =
                              "<div class=\"alert alert-success\" role=\"alert\">Success: Found " + response['srcs'].length.toString() + " diagrams</div>";

                          $('.carousel').carousel()

                      }

                      // $("#diagram-img").attr('src', response['srcs'][0]);
                  },
                  error: function(err) {
                      console.log(err.responseText)
                      document.getElementById("alerts").innerHTML =
                          "<div class=\"alert alert-danger\" role=\"alert\"><h4 class=\"alert-heading\">Failure!</h4><span>Some common sources of error</span><ul><li>Malformed input</li><li>Invalid command/function/predicate</li></ul></div>";
                      document.getElementById('myCarousel').innerHTML =
                              "<div class=\"carousel-item active\"><img src=\"{{ url_for('static',filename='img/empty-diag.jpg') }}\" class=\"d-block w-100\" alt=\"Image 1\" id=\"diagram-img\"></div>";
                      document.getElementById('carousel-targets').innerHTML =
                          "<li data-target=\"#carouselExampleControls\" data-slide-to=\"0\" class=\"active\"></li>";
                  }
              });
          });

      };


    </script>

    <script>

    </script>



  </head>

  <body>

    <!-- CODE MIRROR -->
    <link rel="stylesheet" href="{{ url_for('static',filename='plugin/codemirror/lib/codemirror.css') }}">
    <link rel="stylesheet" href="{{ url_for('static',filename='plugin/codemirror/theme/3024-day.css') }}">
    <script src="{{ url_for('static',filename='plugin/codemirror/lib/codemirror.js') }}"></script>

    <script src="{{ url_for('static',filename='plugin/codemirror/addon/edit/matchbrackets.js') }}"></script>
    <script src="{{ url_for('static',filename='plugin/codemirror/addon/edit/closebrackets.js') }}"></script>
    <script src="{{ url_for('static',filename='plugin/codemirror/keymap/emacs.js') }}"></script>
    <script src="{{ url_for('static', filename='plugin/codemirror/mode/commonlisp/commonlisp.js') }}"></script>

    <!-- BOOTSTRAP -->
    <!--
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>


    <nav class="navbar navbar-expand-lg sticky-top navbar-light bg-light">
      <a class="navbar-brand" href="#">GeoBuilder</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" href="#">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#about">About</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#tutorial">Tutorial</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#examples">Examples</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#contact">Contact</a>
          </li>
        </ul>
      </div>
    </nav>

    <div class="container-fluid p-3">
      <div class="row">
        <div class="col">
          <textarea id="editor"></textarea>
        </div>
        <div class="col">

          <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">

            <ol class="carousel-indicators" id="carousel-targets">

              <li data-target="#carouselExampleControls" data-slide-to="0" class="active"></li>
              <!-- <li data-target="#carouselExampleControls" data-slide-to="1"></li> -->
            </ol>
            <div class="carousel-inner" id="myCarousel">
              <div class="carousel-item active">

                <img src="{{ url_for('static',filename='img/empty-diag.jpg') }}" class="d-block w-100" alt="Image 1" id="diagram-img">
              </div>

              <!--
              <div class="carousel-item">
                <img src="../static/img/diagram_0.png" class="d-block w-100" alt="Image 2">
              </div>
              -->
            </div>
            <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
        </div>
      </div>
    </div>
    <div class="container-fluid">
      <button type="button" id="solve-btn" class="btn btn-primary btn-lg btn-block">Build!</button>
    </div>
    <div class="container-fluid">
      <p id="error"></p>
    </div>
    <div class="container-fluid p-3">
      <p>
        <button class="btn btn-secondary" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
          Advanced Options
        </button>
      </p>
      <div class="collapse" id="collapseExample">
        <div class="card card-body">
          <form>
            <!--
            <div class="custom-control custom-radio">
              <input type="radio" class="custom-control-input" id="customControlValidation2" name="radio-stacked" disabled checked>
              <label class="custom-control-label" for="customControlValidation2">Instructions</label>
            </div>
            <div class="custom-control custom-radio mb-3">
              <input type="radio" class="custom-control-input" id="customControlValidation3" name="radio-stacked" disabled>
              <label class="custom-control-label" for="customControlValidation3">Compilation</label>
            </div>
            -->
            <div class="form-group">
              <label for="num-models">No. of Models</label>
              <div>
                <input class="form-control" type="number" value="1" id="num-models" min="1" max="10">
              </div>
            </div>
            <!-- Should change 0.2 to jinja default size
            <div class="form-group">
              <label for="point-distance">Min. Point Distance</label>
              <div>
                <input class="form-control" type="number" value="0.2" step="0.01" disabled>
              </div>
            </div>
            -->
            <div class="form-group">
              <label for="upload-problem">Upload File</label>
              <input type="file" class="form-control-file" id="upload-problem">
            </div>
          </form>
        </div>
      </div>
    </div>

    <div class="container-fluid" id="alerts"></div>

    <div class="container-fluid" id="about">
      <h1>About</h1>
      <p><strong>GeoBuilder</strong> is a tool for <strong>writing and solving systems of geometric constraints</strong> for olympiad-style geometry problems. <strong>The input to GeoBuilder is a problem statement</strong> (i.e., system of geometric constraints) written in a <strong>custom domain-specific language (DSL)</strong>. This DSL permits reasoning about three types of geometric objects: <strong>points, lines, and circles</strong>. GeoBuilder <strong>outputs diagrams (i.e., models for the constraint system)</strong> that satisfy the problem statement. The user can specify how many such models they would like to generate, and can subsequently download information about these models for inspection. GeoBuilder is also made available as a command-line interface for integration with other tools.</p>
      <p>This work was motivated by an ongoing effort to complete the <a href="https://imo-grand-challenge.github.io">IMO Grand Challenge</a> -- an effort led by Daniel Selsam to build an AI that can win a gold medal at the International Mathematical Olympiad (IMO). The models generated by GeoBuilder are intended to guide solvers for such geometry problems, though it may have uses in other domains (e.g., education, computer-aided design). For technical details, please refer to the <a href="">arXiv paper</a>.</p>
    </div>

    <div class="container-fluid" id="tutorial">
      <h1>Tutorial</h1>
      <p>The following tutorial describes the DSL in which users write GeoBuilder problem statements for model generation. This DSL can broadly be summarized in two parts:</p>
      <ol>
        <li>A set of <strong>commands</strong> to construct a numerical optimization problem to solve for parameterized points, lines, and circles</li>
        <li>A set of <strong>functions and predicates</strong> to define points/lines/circles/numerical values and relationships between them to serve as arguments to the aforementioned commands</li>
      </ol>
      <p>All commands, predicates, and function symbols follow Lisp-style <a href="https://en.wikipedia.org/wiki/S-expression">s-expression</a> format.</p>

      <h2 id="preliminaries">Preliminaries</h2>
      <span>This tutorial makes use of the following notation:</span>
      <ul class="mb-0">
        <!-- <li><code>VAL</code>: The value of a geometric object or numerical value. A value is denoted either by a <code>NAME</code> or a function (see <a href="">Functions and Predicates</a>). Like <code>NAME</code>, <code>VAL</code> is used in this tutorial to refer to a value of any type unless specified (e.g., <code>LINE-VAL</code>). Note that names cannot be given to numerical values</li> -->
        <li>The <code>TYPE</code> of a geometric object can take one of three values: <code>POINT</code>, <code>LINE</code>, or <code>CIRCLE</code></li>
        <li>We use <code>&lt;&gt;</code> to denote an instance of a type. For example, <code>POINT</code> is an instance of <code>TYPE</code> while <code>&lt;POINT&gt;</code> is an instance of <code>POINT</code></li>
        <li>
          A <code>NAME</code> is a string value that refers to a geometric object
          <ul>
            <li><code>NAME</code>s are assigned to geometric objects with the <code>COMPUTE</code> and <code>PARAM</code> commands (see <a href="#commands">Commands</a>)</li>
          </ul>
          <span>Example: If the name <code>P</code> is assigned to the midpoint of two points <code>A</code> and <code>B</code> (e.g., with <code>(COMPUTE P POINT (MIDP A B))</code>), <code>P</code> is an instance of <code>POINT</code></span>
        </li>
        <li><code>PRED</code> and <code>FUNC</code> are used as shorthand for <code>PREDICATE</code> and <code>FUNCTION</code>, respectively</li>.
      </ul>
      <span>Throughout the tutorial, we also refer to the following geometric objects:</span>
      <ul class="mt-0">
        <li><code>A</code>, <code>B</code>, <code>C</code>, and <code>D</code> are instances of <code>POINT</code></li>
        <li><code>L1</code>, <code>L2</code>, and <code>L3</code> are instances of <code>LINE</code></li>
        <li><code>C1</code> and <code>C2</code> are instances of <code>CIRCLE</code></li>
      </ul>

      <h2 id="commands">Commands</h2>
      <p>GeoBuilder generates models by translating a geometric constraint problem into a <strong>numerical optimization problem</strong> and solving it with off-the-shelf optimizers. The following four commands reflect this, and comprise the primary component of the DSL</p>
      <ul>

        <!-- PARAM -->
        <li>
          <code>PARAM</code>: Assigns a <code>NAME</code> to a geometric object parameterized either by the default parameterization for <code>&lt;TYPE&gt;</code> or by a supplied parameterization
          <br>
          <br>
          <div class="container-fluid">
            <div class="container-fluid">
              <blockquote class="blockquote text-center">
                <p class="mb-0"><code>(PARAM &lt;STRING&gt; &lt;TYPE&gt; &lt;OPTIONAL-PARAMETERIZATION&gt;)</code></p>
              </blockquote>
              <span>Each type has the following default parameterization:</span>
              <ul>
                <li><code>POINT</code>: Parameterized by its x- and y-coordinates</li>
                <li><code>LINE</code>: Parameterized by two points that define the line</li>
                <li><code>CIRCLE</code>: Parameterized by its origin and radius (where the origin is parameterized as a point)</li>
              </ul>
              <br>
              <span>The following optional parameterizations can be supplied to...</span>
              <ul>
                <li>... parameterize a <code>POINT</code>:
                  <ul>
                    <li>
                      <code>(ONLINE L1)</code>: Parameterizes a point on line <code>L1</code>
                    </li>
                    <li>
                      <code>(ONSEG A B)</code>: Parameterizes a point on the segment <code><span style="text-decoration:overline">AB</span></code>
                    </li>
                    <li>
                      <code>(ONRAY A B)</code>: Parameterizes a point on the ray starting at <code>A</code> and extending through <code>B</code>
                    </li>
                    <li>
                      <code>(ONRAYOPP A B)</code>: Parameterizes a point beyond <code>A</code> on the ray starting at <code>B</code> extending beyond <code>A</code>
                    </li>
                    <li>
                      <code>(ONCIRC C1)</code>: Parameterizes a point on the circle <code>C1</code>
                    </li>
                    <li>
                      <code>(INPOLY P1 ... PN)</code>: Parameterizes a point inside the polygon with vertices <code>P1</code> ... <code>PN</code>, where <var>N >= 3</var> and <code>P1</code> ... <code>PN</code> are declared points
                    </li>
                  </ul>
                </li>
                <li>... parameterize a <code>LINE</code>:
                  <ul>
                    <li>
                      <code>(THROUGH A)</code>: Parameterizes a line that passes through <code>A</code>
                    </li>
                  </ul>
                </li>
                <li>... parameterize a <code>CIRCLE</code>:
                  <ul>
                    <li>
                      <code>(THROUGH A)</code>: Parameterizes a circle passing through <code>A</code>
                    </li>
                    <li>
                      <code>(ORIGIN A)</code>: Parameterized a circle centered at <code>A</code>
                    </li>
                    <li>
                      <code>(RADIUS N1)</code>: Parameterized a circle with radius <code>N1</code>, where <code>N1</code> is an instance of <code>NUMBER</code>
                    </li>
                  </ul>
                </li>
              </ul>

            </div>
            <br><br>
            <div class="container-fluid">
              <div class="row">
                <div class="col">
                  <div class="card border-success mb-3 mx-auto" style="max-width: 38rem;">
                    <div class="card-header text-success">Valid Usage</div>
                    <div class="card-body">
                      <ul class="list-unstyled">
                        <li>
                          <code>(PARAM P POINT)</code>
                          <ul>
                            <li>Introduces a point <code>P</code> parameterized by its coordinates</li>
                          </ul>
                        </li>
                        <li>
                          <code>(PARAM GAMMA CIRCLE (ORIGIN A))</code>
                          <ul>
                            <li>Introduces a circle <code>GAMMA</code> that is centered at <code>A</code> and is parameterized by it&#39;s radius</li>
                          </ul>
                        </li>
                        <li>
                          <code>(PARAM P POINT (ONCIRC C1))</code>
                          <ul>
                            <li>Introduces a point <code>P</code> parameterized on <code>C1</code>
                          </ul>
                        </li>
                        <li>
                          <code>(PARAM GAMMA CIRCLE)</code>
                          <ul>
                            <li>Introduces a circle <code>GAMMA</code> parameterized by its origin and radius</li>
                          </ul>
                        </li>
                        <li>
                          <code>(PARAM L LINE (THROUGH A))</code>
                          <ul>
                            <li>Introduces a line <code>L</code> that passes through the point <code>A</code></li>
                          </ul>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col">
                  <div class="card border-danger mb-3 mx-auto" style="max-width: 38rem;">
                    <div class="card-header text-danger">Invalid Usage</div>
                    <div class="card-body">
                      <ul class="list-unstyled">
                        <li>
                          <code>(PARAM X NUMBER)</code>
                          <ul>
                            <li>Numerical values cannot be named</li>
                          </ul>
                        </li>
                        <li>
                          <code>(PARAM P POINT (INCIRCLE A B C))</code>
                          <ul>
                            <li><code>(INCIRCLE A B C)</code> is not a valid parameterization of a point</li>
                          </ul>
                        </li>
                        <li>
                          <code>(PARAM P POINT (ONCIRC C1))</code><br><code>(PARAM P POINT)</code>
                          <ul>
                            <li>Cannot introduce the same object twice</li>
                          </ul>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <br>
          <br>
          <p>In addition to the standard grammar for parameterizations outlined above, there is an important variation of <code>PARAM</code> to introduce sets of points that form triangles and polygons. These variations take the following form:</p>
          <blockquote class="blockquote text-center">
            <p class="mb-0"><code>(PARAM (&lt;STRING&gt;, &lt;STRING&gt;, ..., &lt;STRING&gt;) &lt;PARAMETERIZATION&gt;)</code></p>
          </blockquote>
          <p>Note the omission of type information -- the type of <code>(POINT, POINT, ..., POINT)</code> is implied. While it could be standard to infer <code>TYPE</code> in a <code>PARAM</code> (or <code>COMPUTE</code>) command when possible, it is generally enforced to improve readability.</p>
          <span>The following values of <code>&lt;PARAMETERIZATION&gt;</code> are available:</span>
          <ul>
            <li>
              <code>TRIANGLE</code>: Parameterize a list of three points as a triangle
            </li>
            <li>
              <code>ACUTETRI</code>: Parameterize a list of three points as an acute triangle
            </li>
            <li>
              <code>(ISOTRI &lt;STRING&gt;)</code>: Parameterize a list of three points as an isosceles triangle. <code>&lt;STRING&gt;</code> must be in the list of point names being parameterized. For example, <code>(PARAM (P Q R) (ISOTRI P))</code> introduces an isosceles triangle with <var>PQ = PR</var>
            </li>
            <li>
              <code>(ACUTEISOTRI &lt;STRING&gt;)</code>: Parameterize a list of three points as an acute isosceles triangle per the above description of an isosceles parameterization
            </li>
            <li>
              <code>(RIGHTTRI &lt;STRING&gt;)</code>: Parameterize a list of three points as a right triangle. <code>&lt;STRING&gt;</code> must be in the list of point names being parameterized. For example, <code>(PARAM (P Q R) (RIGHTTRI P))</code> introduces a triangle with a right angle at <var>&lt;QPR</var>
            </li>
            <li>
              <code>POLYGON</code>: Parameterize a list of <var>n</var> points as a convex polygon
            </li>
          </ul>
          <br>
          <br>
          <div class="container-fluid">
            <div class="row">
              <div class="col">
                <div class="card border-success mb-3 mx-auto" style="max-width: 38rem;">
                  <div class="card-header text-success">Valid Usage</div>
                  <div class="card-body">
                    <ul class="list-unstyled">
                      <li>
                        <code>(PARAM (P Q R) TRIANGLE)</code>
                        <ul>
                          <li>Introduces three points, <code>P</code>, <code>Q</code>, and <code>R</code> that form a triangle</li>
                        </ul>
                      </li>
                      <li>
                        <code>(PARAM (P Q R) (ISOTRI Q))</code>
                        <ul>
                          <li>Introduce three points that form an isosceles triangle with <var>QP = QR</var></li>
                        </ul>
                      </li>
                      <li>
                        <code>(PARAM (P Q R S T) POLYGON)</code>
                        <ul>
                          <li>Introduces five points, <code>P</code>, <code>Q</code>, <code>R</code>, <code>S</code>, and <code>T</code>, that form a convex pentagon</li>
                        </ul>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="col">
                <div class="card border-danger mb-3 mx-auto" style="max-width: 38rem;">
                  <div class="card-header text-danger">Invalid Usage</div>
                  <div class="card-body">
                    <ul class="list-unstyled">
                      <li>
                        <code>(PARAM (P Q R S) TRIANGLE)</code>
                        <ul>
                          <li>Only lists of points of length three can be parameterized as a triangle</li>
                        </ul>
                      </li>
                      <li>
                        <code>(PARAM (P Q R) (ISOTRI A))</code>
                        <ul>
                          <li>The argument to <code>ISOTRI</code> must be a point in the isosceles triangle (i.e., a point being introduced)</li>
                        </ul>
                      </li>
                      <li>
                        <code>(PARAM (P Q) POLYGON)</code>
                        <ul>
                          <li>A polygon has at least three vertices</li>
                        </ul>
                      </li>
                      <li>
                        <code>(PARAM (P Q R) (POINT POINT POINT) TRIANGLE)</code>
                        <ul>
                          <li>Type information should not be included for commands introducing lists of points that form triangles/polygons</li>
                        </ul>
                      </li>
                      <li>
                        <code>(PARAM (P Q R))</code>
                        <ul>
                          <li>When parameterizing a list of points, <code>&lt;PARAMETERIZATION&gt;</code> is required</li>
                        </ul>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </li>


        <!-- COMPUTE -->
        <li>
          <code>COMPUTE</code>: Assigns a <code>NAME</code> to a geometric object computed from existing objects. <code>&lt;VALUE&gt;</code> is one of <code>&lt;POINT&gt;</code>, <code>&lt;LINE&gt;</code>, or <code>&lt;CIRCLE&gt;</code>.
          <br>
          <br>
          <div class="container-fluid">
            <div class="container-fluid">
              <blockquote class="blockquote text-center">
                <p class="mb-0"><code>(COMPUTE &lt;STRING&gt; &lt;TYPE&gt; &lt;VALUE&gt;)</code></p>
              </blockquote>
            </div>
            <br>
            <div class="container-fluid">
              <div class="row">
                <div class="col">
                  <div class="card border-success mb-3 mx-auto" style="max-width: 38rem;">
                    <div class="card-header text-success">Valid Usage</div>
                    <div class="card-body">
                      <ul class="list-unstyled">
                        <li>
                          <code>(COMPUTE P POINT (INCENTER A B C))</code>
                          <ul>
                            <li><code>P</code> is assigned to the incenter of a triangle with vertices <code>A</code>, <code>B</code>, and <code>C</code></li>
                          </ul>
                        </li>
                        <li>
                          <code>(COMPUTE GAMMA CIRCLE (INCIRCLE A B C))</code>
                          <ul>
                            <li><code>GAMMA</code> is assigned to the incircle of a triangle with vertices <code>A</code>, <code>B</code>, and <code>C</code></li>
                          </ul>
                        </li>
                        <li>
                          <code>(COMPUTE L LINE (PERPBIS B C))</code>
                          <ul>
                            <li><code>L</code> is assigned to the perpendicular bisector of the segment connecting <code>B</code> and <code>C</code></li>
                          </ul>
                        </li>
                      </ul>

                    </div>
                  </div>
                </div>
                <div class="col">
                  <div class="card border-danger mb-3 mx-auto" style="max-width: 38rem;">
                    <div class="card-header text-danger">Invalid Usage</div>
                    <div class="card-body">
                      <ul class="list-unstyled">
                        <li>
                          <code>(COMPUTE X NUMBER (DIST A B))</code>
                          <ul>
                            <li>Numerical values cannot be named</li>
                          </ul>
                        </li>
                        <li>
                          <code>(COMPUTE P POINT (INCIRCLE A B C))</code>
                          <ul>
                            <li>The type of <code>&lt;VALUE&gt;</code> must be consistent with <code>&lt;TYPE&gt;</code></li>
                          </ul>
                        </li>
                        <li>
                          <code>(COMPUTE P POINT A)</code>
                          <ul>
                            <li><code>&lt;VALUE&gt;</code> cannot be a <code>NAME</code> as duplicate objects are not permitted</li>
                          </ul>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <br>
          <p>Note that detail on functions used in the above examples (e.g., <code>INCENTER</code>, <code>DIST</code>) is provided in the next section</p>
        </li>


        <!-- ASSERT -->
        <li>
          <code>ASSERT</code>: Imposes an additional constraint <code>&lt;PRED&gt;</code> on the system. This command does not introduce any <em>new</em> geometric objects and can only refer to those that have already been introduced by either <code>COMPUTE</code> or <code>PARAM</code>.
          <br>
          <br>
          <div class="container-fluid">
            <div class="container-fluid">
              <blockquote class="blockquote text-center">
                <p class="mb-0"><code>(ASSERT &lt;PRED&gt;)</code></p>
              </blockquote>
            </div>
            <br>
            <div class="container-fluid">
              <div class="row">
                <div class="col">
                  <div class="card border-success mb-3 mx-auto" style="max-width: 38rem;">
                    <div class="card-header text-success">Valid Usage</div>
                    <div class="card-body">
                      <ul class="list-unstyled">
                        <li>
                          <code>(ASSERT (PARA L1 L2))</code>
                          <ul>
                            <li>Assert that line <code>L1</code> is parallel to line <code>L2</code></li>
                          </ul>
                        </li>
                        <li>
                          <code>(ASSERT (NOT (COLL A B C)))</code>
                          <ul>
                            <li>Assert that points <code>A</code>, <code>B</code>, and <code>C</code> are <em>not</em> collinear</li>
                          </ul>
                        </li>
                        <li>
                          <code>(ASSERT (EQ 4.0 (DIST A B)))</code>
                          <ul>
                            <li>Numerical values find their place in <code>ASSERT</code>. The above asserts that the distance between points <code>A</code> and <code>B</code> is 4.0</li>
                          </ul>
                        </li>
                      </ul>

                    </div>
                  </div>
                </div>
                <div class="col">
                  <div class="card border-danger mb-3 mx-auto" style="max-width: 38rem;">
                    <div class="card-header text-danger">Invalid Usage</div>
                    <div class="card-body">
                      <ul class="list-unstyled">
                        <li>
                          <code>(ASSERT (PARA L1 L2) (NOT (COLL A B C)))</code>
                          <ul>
                            <li>Assertions are made one at a time</li>
                          </ul>
                        </li>
                        <li>
                          <code>(ASSERT (COLL P Q R))</code>
                          <ul>
                            <li>Assertions cannot introduce geometric objects, and <code>P</code>, <code>Q</code>, and <code>R</code> have not been assigned (see <a href="#preliminaries">Preliminaries</a>)</li>
                          </ul>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <br>
          <p>Detail on supported predicates (e.g., <code>PARA</code>, <code>COLL</code>) is provided in the following section</p>.
        </li>
        <!-- CONFIRM -->
        <li>
          <code>CONFIRM</code>: Filter final solutions by those in which <code>&lt;PRED&gt;</code> is satisfied. Like <code>ASSERT</code>, this command does not introduce any new geometric objects.
          <br>
          <br>
          <div class="container-fluid">
            <div class="container-fluid">
              <blockquote class="blockquote text-center">
                <p class="mb-0"><code>(CONFIRM &lt;PRED&gt;)</code></p>
              </blockquote>
            </div>
          </div>
          <p>Usage for <code>CONFIRM</code> is the same as that for <code>ASSERT</code>. The key distinction between <code>ASSERT</code> and <code>CONFIRM</code> is that <strong><code>CONFIRM</code> does not enforce <code>&lt;PRED&gt;</code> via numerical optimization</strong>. This command is most useful for those interested in integrating GeoBuilder with automated theorem provers. As many problem statements are of the form "If X, prove Y," one may wish to optimize directly for X while only checking that Y holds in the final model.</p>
        </li>
      </ul>


      <h2>Functions and Predicates</h2>
      <p>Per the above section, GeoBuilder operates on a set of commands that accept points, lines, circles, numerical values, and predicates as arguments. In the following, we provide a sample of the functions and predicates by which a user can define such arguments. For a complete list, please reference the appendices in our <a href="">arXiv paper</a>.</p>

      <h3>Functions</h3>
      <p>Functions construct new geometric objects, as well as numerical values for dimensional constraints, from ones already declared. Functions in our DSL include a unique feature -- <strong>root selectors</strong>. Root selectors are included to address the issue that when geometric constraints are translated to numerical ones, many solutions often exist which are degenerate in their geometric interpretation. In plane geometry, this problem typically manifests with multiple candidate <code>POINT</code> solutions, such as the intersection between a line and a circle.</p>
      <p>To control for this, we introduce a set of root selectors for plane geometry to be used in several functions of type <code>POINT</code>:
        <ul>
          <li><code>rsArbitrary</code>: An arbitrary root</li>
          <li><code>(rsNeq A)</code>: The root that does not equal <code>A</code></li>
          <li><code>(rsOppSides A L1)</code>: The root on the opposite side of <code>L1</code> as <code>A</code></li>
          <li><code>(rsSameSide A L1)</code>: The root on the same side of <code>L1</code> as <code>A</code></li>
        </ul>
        The functions <code>interLC</code> and <code>interCC</code> require a root selector.
      </p>

      <p>
        Keeping this concept in mind, we now introduce a set of commonly used functions to...
        <ul>
          <li>
            <span>... construct a <code>POINT</code></span>
            <ul>
              <li><code>(midp A B)</code>: The midpoint of <code>A</code> and <code>B</code></li>
              <li><code>(interLL L1 L2)</code>: The intersection of <code>L1</code> and <code>L2</code></li>
              <li><code>(circumcenter A B C)</code>: The circumcenter of the triangle with vertices <code>A</code>, <code>B</code>, and <code>C</code></li>
              <li><code>(orthocenter A B C)</code>: The orthocenter of the triangle with vertices <code>A</code>, <code>B</code>, and <code>C</code></li>
              <li><code>(interLC L1 C1 &lt;ROOT-SELECTOR&gt;)</code>: The intersection of <code>L1</code> and <code>C1</code> as specified by a root selector</li>
            </ul>
          </li>
          <li>
            <span>... construct a <code>LINE</code></span>
            <ul>
              <li><code>(line A B)</code>: The line connecting <code>A</code> and <code>B</code></li>
              <li><code>(perpBis A B)</code>: The perpendicular bisector of line <code><span style="text-decoration:overline">AB</span></code></li>
              <li><code>(perpAt C A B)</code>: The line through <code>C</code> that is perpendicular to line <code><span style="text-decoration:overline">AB</span></code></li>
            </ul>
          </li>
          <li>
            <span>... construct a <code>CIRCLE</code></span>
            <ul>
              <li><code>(circ A B C)</code>: The circle passing through <code>A</code>, <code>B</code>, and <code>C</code></li>
              <li><code>(incircle A B C)</code>: The incircle of the triangle with vertices <code>A</code>, <code>B</code>, and <code>C</code></li>
              <li><code>(diam A B)</code>: The circle with diameter <code><span style="text-decoration:overline">AB</span></code></li>
            </ul>
          </li>
          <li>
            <span>... construct a <code>NUMBER</code></span>
            <ul>
              <li><code>(dist A B)</code>: The length of the segment <code><span style="text-decoration:overline">AB</span></code></li>
              <li><code>(uangle A B C)</code>: The undirected angle measure &angle;<code>ABC</code></li>
              <li><code>(add</code>/<code>sub</code>/<code>mul</code>/<code>div</code>/<code>pow N1 N2)</code>: The standard binary operations, where <code>N1</code> and <code>N2</code> are instances of <code>NUMBER</code></li>
              <li><code>(neg</code>/<code>sqrt N1)</code>: The standard unary operations, where <code>N1</code> is an instance of <code>NUMBER</code></li>
            </ul>
          </li>
        </ul>
      </p>


      <h3>Predicates</h3>
      <p>
        Predicates describe relationships between geometric objects or numerical values. As with functions, here we provide a sample of commonly used predicates and the reader should refer to our <a href="">arXiv paper</a> for a full list:
        <ul>
          <li><code>(cong A B C D)</code>: True i.f.f. the segments <code><span style="text-decoration:overline">AB</span></code> and <code><span style="text-decoration:overline">CD</span></code> are congruent</li>
          <li><code>(coll A B C)</code>: True i.f.f. <code>A</code>, <code>B</code>, and <code>C</code> are collinear</li>
          <li><code>(eq A B)</code>: True i.f.f. <code>A</code> = <code>B</code></li>
          <li><code>(eq N1 N2)</code>: True i.f.f. <code>N1</code> = <code>N2</code>, where <code>N1</code> and <code>N2</code> are instances of <code>NUMBER</code></li>
          <li><code>(onLine A L1)</code>: True i.f.f. <code>A</code> is on line <code>L1</code></li>
          <li><code>(onCirc A C1)</code>: True i.f.f. <code>A</code> is on circle <code>C1</code></li>
          <li><code>(onSeg C A B)</code>: True i.f.f. <code>C</code> is on the segment <code><span style="text-decoration:overline">AB</span></code></li>
          <li><code>(onRay C A B)</code>: True i.f.f. <code>C</code> is on the ray starting at <code>A</code> that extends through <code>B</code></li>
          <li><code>(concur L1 L2 L3)</code>: True i.f.f. lines <code>L1</code>, <code>L2</code>, and <code>L3</code> intersect at a common point</li>
        </ul>
      </p>

      <h3>Example Usage</h3>
      <p>Here we provide examples of valid and invalid usage of functions and predicates to construct arguments for commands:</p>
      <div class="container-fluid">
        <div class="row">
          <div class="col">
            <div class="card border-success mb-3 mx-auto" style="max-width: 38rem;">
              <div class="card-header text-success">Valid Usage</div>
              <div class="card-body">
                <ul class="list-unstyled">
                  <li>
                    <code>(PARAM P POINT (onSeg A (MIDP A B)))</code>
                    <ul>
                      <li>Parameterize a point <code>P</code> on the segment connecting <code>A</code> and <code>(MIDP A B)</code></li>
                    </ul>
                  </li>
                  <li>
                    <code>(COMPUTE P POINT (interLC L1 C1 rsArbitrary))</code>
                    <ul>
                      <li>Compute a point <code>P</code> as <em>any</em> intersection of the line <code>L1</code> with the circle <code>C1</code></li>
                    </ul>
                  </li>
                  <li>
                    <code>(COMPUTE Q POINT (interLC L1 C1 (rsNeq P)))</code>
                    <ul>
                      <li>Compute a point <code>Q</code> as the intersection of the line <code>L1</code> with the circle <code>C1</code> that is <em>not</em> <code>P</code></li>
                    </ul>
                  </li>
                  <li>
                    <code>(PARAM GAMMA CIRCLE (origin (interLL L1 (perpBis A B))))</code>
                    <ul>
                      <li>Parameterize a circle <code>GAMMA</code> whose origin is the intersection of <code>L1</code> and the perpendicular bisector of the segment <code><span style="text-decoration:overline">AB</span></code></li>
                    </ul>
                  </li>
                  <li>
                    <code>(ASSERT (eq C (midp A B)))</code>
                    <ul>
                      <li>Assert that <code>C</code> is the midpoint of the segment <code><span style="text-decoration:overline">AB</span></code></li>
                    </ul>
                  </li>
                </ul>

              </div>
            </div>
          </div>
          <div class="col">
            <div class="card border-danger mb-3 mx-auto" style="max-width: 38rem;">
              <div class="card-header text-danger">Invalid Usage</div>
              <div class="card-body">
                <ul class="list-unstyled">
                  <li>
                    <code>(ASSERT (interLL L1 L2))</code>
                    <ul>
                      <li>Assertions take predicates as arguments, not functions</li>
                    </ul>
                  </li>
                  <li>
                    <code>(COMPUTE P POINT (interLC L1 C1))</code>
                    <ul>
                      <li>Root selectors are required, even if you do not care which root is selected</li>
                    </ul>
                  </li>
                  <li>
                    <code>(ASSERT (eq A B))</code>
                    <ul>
                      <li>While technically a valid command, duplicate points are not allowed so this assertion will prevent a model from being found</li>
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>


    </div>

    <div class="container-fluid" id="examples">
      <h1>Examples</h1>
      <p>The following examples are adapted from <a href="https://www.imo-official.org/problems.aspx">previous IMO problems</a>, as well as problems found in <a href="https://web.evanchen.cc/geombook.html">Evan Chen&#39;s "Euclidean Geometry in Mathematical Olympiads" (EGMO)</a>.</p>

      <h3>IMO FIXME, Problem FIXME</h3>
      <div class="container-fluid">
        <blockquote class="blockquote text-center">
          <p class="mb-0">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer posuere erat a ante.</p>
        </blockquote>
      </div>

      <h3>The Five-Circle Theorem</h3>
      <div class="container-fluid">

        <blockquote class="blockquote text-center">
          <p class="mb-0">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer posuere erat a ante.</p>
        </blockquote>

        <!-- <div class="container p-3" style="height: 50vh;"> -->
        <div class="container-fluid p-3">
          <div class="row justify-content-center">
            <div class="block col-sm-4">
              <textarea id="five-circle"></textarea>
            </div>
            <div class="block col-sm-4">
              <!-- <img src="{{ url_for('static',filename='img/empty-diag.jpg') }}" class="d-block w-100" alt="Image 1"> -->
              <img src="{{ url_for('static',filename='img/empty-diag.jpg') }}" class="d-block w-100" alt="Image 1">
            </div>
          </div>
        </div>


      </div>

    </div>

    <div class="container-fluid" id="contact">
      <h1>Contact</h1>
      <p>GeoBuilder is extensible in nature. Should you have any feature suggestions (e.g., new function symbols or predicates) or encounter any bugs, please open an issue on <a href="">GitHub</a>. For other inquiries, please contact <a href="mailto:ryankrue@umich.edu">ryankrue@umich.edu</a></p>
    </div>

    <!-- Footer -->
    <footer class="page-footer font-small bg-light">
      <br>
      <br>
      <!--
      <div class="footer-copyright text-center py-3"> 2020 Copyright:
        <a href="https://mdbootstrap.com/"> MDBootstrap.com</a>
      </div>
      -->


    </footer>
    <!-- Footer -->

  </body>
</html>
